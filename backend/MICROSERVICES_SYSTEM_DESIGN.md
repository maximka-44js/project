# üèóÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∑–∞–π–Ω –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—é–º–µ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã—Ö –æ–∂–∏–¥–∞–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI.

## üìä –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

### 1. üö™ API Gateway (FastAPI + Nginx)
**–ü–æ—Ä—Ç:** 8000  
**–†–æ–ª—å:** –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, rate limiting  

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º
- JWT —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–∞—Ü–∏—è
- Rate limiting (6 req/min –¥–ª—è –ø–æ–ª–ª–∏–Ω–≥–∞)
- CORS –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–æ—É—Ç—ã:**
```
/api/v1/auth/*        ‚Üí Auth Service
/api/v1/emails/*      ‚Üí Email Service  
/api/v1/resumes/*     ‚Üí Resume Service
/api/v1/analysis/*    ‚Üí Analysis Service
```

### 2. üîê Auth Service (FastAPI)
**–ü–æ—Ä—Ç:** 8001  
**–ë–î:** PostgreSQL (auth_db)  

**–§—É–Ω–∫—Ü–∏–∏:**
- OAuth2 –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Google, GitHub)
- JWT —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏—è
- Refresh —Ç–æ–∫–µ–Ω—ã
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**API:**
```
POST /oauth/google     - Google OAuth
POST /oauth/github     - GitHub OAuth  
POST /refresh          - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
GET  /me              - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### 3. üìß Email Service (FastAPI)
**–ü–æ—Ä—Ç:** 8002  
**–ë–î:** PostgreSQL (emails_db)  
**–ö—ç—à:** Redis  

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è email –∞–¥—Ä–µ—Å–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
- SMTP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**API:**
```
POST /subscribe              - –ü–æ–¥–ø–∏—Å–∫–∞
GET  /status/{email}         - –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
POST /send-results           - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (internal)
```

### 4. üìÑ Resume Service (FastAPI)
**–ü–æ—Ä—Ç:** 8003  
**–ë–î:** PostgreSQL (resumes_db)  
**Storage:** S3 (—Å–Ω–∞—á–∞–ª–∞ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–∞—Ö)

**–§—É–Ω–∫—Ü–∏–∏:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ä–µ–∑—é–º–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ (PDF, DOC, DOCX, TXT)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –ü–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞

**API:**
```
POST /upload                 - –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ
GET  /supported-formats      - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
GET  /{id}/content          - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–µ–∑—é–º–µ (internal)
```

### 5. üîç Analysis Service (FastAPI)
**–ü–æ—Ä—Ç:** 8004  
**–ë–î:** PostgreSQL (analysis_db)  
**Queue:** Redis
**Worker:** Celery  

**–§—É–Ω–∫—Ü–∏–∏:**
- –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ —Å –ø–æ–º–æ—â—å—é LLM
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã—Ö –æ–∂–∏–¥–∞–Ω–∏–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä—ã–Ω–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**API:**
```
POST /start                  - –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞ (internal)
GET  /{id}                  - –°—Ç–∞—Ç—É—Å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
POST /webhook               - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (internal)
```

## üóÑÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```
PostgreSQL (Docker)
‚îú‚îÄ‚îÄ auth_db      - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ç–æ–∫–µ–Ω—ã
‚îú‚îÄ‚îÄ emails_db    - Email –ø–æ–¥–ø–∏—Å–∫–∏  
‚îú‚îÄ‚îÄ resumes_db   - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤
‚îî‚îÄ‚îÄ analysis_db  - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```
Redis (Docker)
‚îú‚îÄ‚îÄ JWT blacklist
‚îú‚îÄ‚îÄ Rate limiting counters
‚îú‚îÄ‚îÄ Email —Å—Ç–∞—Ç—É—Å—ã
‚îî‚îÄ‚îÄ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```
MinIO/S3
‚îî‚îÄ‚îÄ resumes/
    ‚îú‚îÄ‚îÄ original/     - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
    ‚îî‚îÄ‚îÄ processed/    - –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
```

### –û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á
```
RabbitMQ + Celery
‚îú‚îÄ‚îÄ analysis.start    - –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ email.send       - –û—Ç–ø—Ä–∞–≤–∫–∞ email
‚îî‚îÄ‚îÄ cleanup.files    - –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
```

## üîÑ –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```mermaid
graph TB
    Frontend[Frontend Next.js] --> Gateway[API Gateway :8000]
    
    Gateway --> Auth[Auth Service :8001]
    Gateway --> Email[Email Service :8002] 
    Gateway --> Resume[Resume Service :8003]
    Gateway --> Analysis[Analysis Service :8004]
    
    Auth --> AuthDB[(PostgreSQL auth_db)]
    Auth --> Redis[(Redis Cache)]
    
    Email --> EmailDB[(PostgreSQL emails_db)]
    Email --> Redis
    Email --> SMTP[SMTP Server]
    
    Resume --> ResumeDB[(PostgreSQL resumes_db)]
    Resume --> S3[(MinIO/S3 Storage)]
    Resume --> Queue[RabbitMQ]
    
    Analysis --> AnalysisDB[(PostgreSQL analysis_db)]
    Analysis --> Queue
    Analysis --> Worker[Celery Workers]
    Analysis --> LLM[AI/LLM Service]
    
    Worker --> Email
    Queue --> Worker
```

## üöÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** ‚Üí Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
2. **Email –ø–æ–¥–ø–∏—Å–∫–∞** ‚Üí Gateway ‚Üí Email Service ‚Üí PostgreSQL
3. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ** ‚Üí Gateway ‚Üí Resume Service ‚Üí S3 + PostgreSQL
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞** ‚Üí Resume Service ‚Üí RabbitMQ ‚Üí Analysis Service
5. **–ü–æ–ª–ª–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞** ‚Üí Frontend ‚Üí Gateway ‚Üí Analysis Service (–∫–∞–∂–¥—ã–µ 10—Å–µ–∫)
6. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞** ‚Üí Celery Worker ‚Üí Analysis Service ‚Üí Email Service
7. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** ‚Üí Email Service ‚Üí SMTP ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend:** FastAPI + Python 3.11
- **Databases:** PostgreSQL 15
- **Cache:** Redis 7
- **Queue:** RabbitMQ + Celery
- **Storage:** MinIO (S3-compatible)
- **Gateway:** Nginx + FastAPI
- **Deployment:** Docker + Docker Compose
- **Monitoring:** Prometheus + Grafana

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- JWT —Ç–æ–∫–µ–Ω—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º TTL (15 –º–∏–Ω)
- Refresh —Ç–æ–∫–µ–Ω—ã (7 –¥–Ω–µ–π)
- Rate limiting –Ω–∞ Gateway
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
- Encrypted storage –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- Load balancer –Ω–∞ Gateway —É—Ä–æ–≤–Ω–µ  
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (—Ä–µ–∑—é–º–µ)

---
*–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –Ω–∞–≥—Ä—É–∑–∫—É –¥–æ 1000 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.*